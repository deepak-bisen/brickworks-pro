# ===================================================================
# SERVICE IDENTIFICATION & PORT
# ===================================================================
# This is the single, fixed port our frontend will talk to.
server.port=9191
spring.application.name=api-gateway

# ===================================================================
# EUREKA CLIENT CONFIGURATION
# ===================================================================
# The gateway needs to find other services, so it connects to Eureka.
eureka.client.service-url.defaultZone=http://localhost:8761/eureka

# ===================================================================
# GATEWAY ROUTING RULES
# ===================================================================
# Enable service discovery for routing. This lets us use service names (e.g., "lb://product-service")
spring.cloud.gateway.discovery.locator.enabled=true
spring.cloud.gateway.discovery.locator.lower-case-service-id=true

# --- Route to employee-service ---
# Rule 0: Requests to /api/auth/** will go to the employee-service.
spring.cloud.gateway.routes[0].id=employee-service
spring.cloud.gateway.routes[0].uri=lb://employee-service
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/auth/**

# --- Route to product-service ---
# Rule 1: Requests to /api/products/** will go to the product-service.
# 'lb' stands for 'load-balanced' (it will find the service via Eureka).
spring.cloud.gateway.routes[1].id=product-service
spring.cloud.gateway.routes[1].uri=lb://product-service
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/products/**

# --- Route to customer-service ---
# Rule 2: Requests to /api/customers/** will go to the customer-service.
spring.cloud.gateway.routes[2].id=customer-service
spring.cloud.gateway.routes[2].uri=lb://customer-service
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/customers/**

# --- Route to order-service ---
# Rule 3: Requests to /api/orders/** will go to the order-service.
spring.cloud.gateway.routes[3].id=order-service
spring.cloud.gateway.routes[3].uri=lb://order-service
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/orders/**

# ===================================================================
# GLOBAL CORS CONFIGURATION
# ===================================================================
# This is the new section that fixes the browser "Failed to fetch" error.
# It tells the gateway to accept requests from any origin (*).
#spring.cloud.gateway.globalcors.cors-configurations.default.allowed-origins=*
#spring.cloud.gateway.globalcors.cors-configurations.default.allowed-methods=*
#spring.cloud.gateway.globalcors.cors-configurations.default.allowed-headers=*